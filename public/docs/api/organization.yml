/organizations:
  get:
    summary: Get organization tree
    tags:
    - Organizations
    consumes:
    - application/json
    responses:
      200:
        description: return organization tree
        content:
          application/json:
            schema:
              $ref: '../schema.yml#/Organization'
      403:
        description: Unauthorized
        content:
          application/json:
            schema:
              $ref: '../schema.yml#/UnauthorizedError'
      401:
        description: Unauthenticated
        content:
          application/json:
            schema:
              $ref: '../schema.yml#/UnauthenticatedError'
  post:
    summary: Create an organization
    tags:
    - Organizations
    consumes:
    - application/json
    requestBody:
      content:
        application/json:
          schema:
            type: object
            properties:
              name:
                type: string
                description: Organization name
              level:
                type: integer
                description: Level ID
              manager_id:
                type: integer
                description: Manager id
              parent_id:
                type: integer
                description: Organization's parent
            required:
            - name
            - level
            - manager_id
          example:
            name: Group 1
            parent_id: 2
            manager_id: 4
            level: 2
    responses:
      201:
        description: Organization Created Successful
        content:
          application/json:
            schema:
              $ref: '../schema.yml#/Organization'
      400:
        description: Invalid Param
        content:
          application/json:
            schema:
              $ref: '../schema.yml#/Error'
          example:
            error:
              code: 400
              message: name is missing
      403:
        description: Unauthorized
        content:
          application/json:
            schema:
              $ref: '../schema.yml#/UnauthorizedError'
            examples:
              no_authorization:
                value:
                  error:
                    code: 403
                    message: unauthorized
              employee:
                value:
                  error:
                    code: 403
                    message: unauthorized
      401:
        description: Unauthenticated
        content:
          application/json:
            schema:
              $ref: '../schema.yml#/UnauthenticatedError'
/organizations/{id}:
  get:
    summary: Information of an organization
    tags:
    - Organizations
    consumes:
    - application/json
    parameters:
    - name: id
      in: path
      type: integer
      description: Organization ID
      required: true
    responses:
      200:
        description: returns the organization information
        content:
          application/json:
            schema:
              $ref: '../schema.yml#/Organization'
            example:
              id: 1
              parent_id:
              manager_id: 2
              level: division
              name: Division 1
              children:
              - id: 2
                parent_id: 1
                manager_id: 3
                level: section
                name: Section 1
                children:
                - id: 3
                  parent_id: 2
                  manager_id: 4
                  level: clan
                  name: Clan 1
                  children:
                  - id: 4
                    parent_id: 3
                    manager_id: 5
                    level: team
                    name: Team 1
                    children: []
                  - id: 5
                    parent_id: 3
                    manager_id: 6
                    level: team
                    name: Team 2
                    children: []
      404:
        description: returns invalid id error
        content:
          application/json:
            schema:
              $ref: '../schema.yml#/Error'
            example:
              error:
                code: 404
                message: Couldn't find Organization with 'id'=0
      403:
        description: Unauthorized
        content:
          application/json:
            schema:
              $ref: '../schema.yml#/UnauthorizedError'
            examples:
              no_authorization:
                value:
                  error:
                    code: 403
                    message: unauthorized
              employee:
                value:
                  error:
                    code: 403
                    message: unauthorized
      401:
        description: Unauthenticated
        content:
          application/json:
            schema:
              $ref: '../schema.yml#/UnauthenticatedError'
  patch:
    summary: Update an organization
    tags:
    - Organizations
    consumes:
    - application/json
    requestBody:
      content:
        application/json:
          schema:
            type: object
            properties:
              id:
                type: integer
                description: Organization ID
              name:
                type: string
                description: Organization name
              level:
                type: integer
                description: Level ID
              manager_id:
                type: integer
                description: Manager id
              parent_id:
                type: integer
                description: Organization's parent
            required:
            - id
            - name
            - level
            - manager_id
          example:
            id: 3
            name: Group 1
            parent_id: 2
            manager_id: 4
            level: 2
    responses:
      200:
        description: updated an organization
        content:
          application/json:
            schema:
              $ref: '../schema.yml#/Organization'
            example:
              id: 3
              name: Group 1
              parent_id: 2
              manager_id: 4
              level: clan
              children: []
      400:
        description: Invalid params
        content:
          application/json:
            schema:
              $ref: '../schema.yml#/Error'
            example:
              error:
                code: 400
                message: name is missing
      403:
        description: Unauthorized
        content:
          application/json:
            schema:
              $ref: '../schema.yml#/UnauthorizedError'
            examples:
              no_authorization:
                value:
                  error:
                    code: 403
                    message: unauthorized
              employee:
                value:
                  error:
                    code: 403
                    message: unauthorized
      404:
        description: returns invalid id error
        content:
          application/json:
            schema:
              $ref: '../schema.yml#/Error'
            example:
              error:
                code: 404
                message: Couldn't find Organization with 'id'=0
      401:
        description: Unauthenticated
        content:
          application/json:
            schema:
              $ref: '../schema.yml#/UnauthenticatedError'
  delete:
    summary: Deletes an organization
    tags:
    - Organizations
    consumes:
    - application/json
    parameters:
    - name: id
      in: path
      type: integer
      description: Organization ID
      required: true
    responses:
      200:
        description: Delete Organization
        content:
          application/json:
            schema:
              $ref: '../schema.yml#/SuccessMessage'
      403:
        description: Unauthorized
        content:
          application/json:
            schema:
              $ref: '../schema.yml#/UnauthorizedError'
      404:
        description: returns invalid id error
        content:
          application/json:
            schema:
              $ref: '../schema.yml#/Error'
            example:
              error:
                code: 404
                message: Couldn't find Organization with 'id'=0
      401:
        description: Unauthenticated
        content:
          application/json:
            schema:
              $ref: '../schema.yml#/UnauthenticatedError'
/organizations/{id}/employees:
  parameters:
  - name: id
    in: path
    type: integer
    description: Organization ID
    required: true
  patch:
    summary: Update an organization for employees
    tags:
    - Organizations
    requestBody:
      content:
        application/json:
          schema:
            type: object
            properties:
              employees:
                type: array
                items:
                  type: integer
            required:
              employees
          example:
            employees: [1, 2, 3]

    responses:
      200:
        description: Add employee to Organization
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: '../schema.yml#/Employee'
            examples:
              admin:
                summary: Admin & manager
                value:
                - id: 1
                  organization_id: 1
                  name: Employee
                  employee_code: B120000
                  email: employee@framgia.com
                  birthday: "2018-01-01"
                  phone: '0123456789'
                  avatar: "#"
              blank_param:
                value: []
      403:
        description: Unauthorized
        content:
          application/json:
            schema:
              $ref: '../schema.yml#/UnauthorizedError'
            examples:
              no_authorization:
                value:
                  error:
                    code: 403
                    message: unauthorized
              employee:
                value:
                  error:
                    code: 403
                    message: unauthorized
      401:
        description: Unauthenticated
        content:
          application/json:
            schema:
              $ref: '../schema.yml#/UnauthenticatedError'
/organizations/{id}/employees/{employee_id}:
  parameters:
  - name: id
    in: path
    type: integer
    description: Organization ID
    required: true
  - name: employee_id
    in: path
    type: integer
    description: Employee ID
    required: true

  delete:
    summary: Deletes an organization employee
    tags:
    - Organizations
    consumes:
    - application/json
    responses:
      200:
        description: manager of organization can delete employee
        content:
          application/json:
            schema:
              $ref: '../schema.yml#/SuccessMessage'
            examples:
              admin:
                value:
                  message: Delete successfully
              manager_of_organization:
                value:
                  message: Delete successfully
      404:
        description: Model not found
        content:
          application/json:
            schema:
              $ref: '../schema.yml#/Error'
            examples:
              employee_not_found:
                value:
                  error:
                    code: 404
                    message: Couldn't find Employee with 'id'=0
              organization_not_found:
                value:
                  error:
                    code: 404
                    message: Couldn't find Organization with 'id'=0
      403:
        description: Unauthorized
        content:
          application/json:
            schema:
              $ref: '../schema.yml#/UnauthorizedError'
            examples:
              no_authorization:
                value:
                  error:
                    code: 403
                    message: unauthorized
              employee:
                value:
                  error:
                    code: 403
                    message: unauthorized
              manager_other:
                summary: manager of other organization
                value:
                  error:
                    code: 403
                    message: unauthorized
      401:
        description: Unauthenticated
        content:
          application/json:
            schema:
              $ref: '../schema.yml#/UnauthenticatedError'
